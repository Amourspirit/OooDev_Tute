<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LibreOffice and Python to Work With Excel Spreadsheets &mdash; Tute 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="_static/dark_mode_css/dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/tabs.js"></script>
        <script src="_static/dark_mode_js/default_dark.js"></script>
        <script src="_static/dark_mode_js/theme_switcher.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Tute
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">LibreOffice and Python to Work With Excel Spreadsheets</a><ul>
<li><a class="reference internal" href="#excel-documents">Excel Documents</a></li>
<li><a class="reference internal" href="#installing-ooodev">Installing OooDev</a></li>
<li><a class="reference internal" href="#working-with-python-and-libreoffice">Working with Python and LibreOffice</a><ul>
<li><a class="reference internal" href="#reading-excel-documents">Reading Excel Documents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#opening-excel-documents-with-ooodev">Opening Excel Documents with OooDev</a></li>
<li><a class="reference internal" href="#getting-sheets-from-the-workbook">Getting Sheets from the Workbook</a></li>
<li><a class="reference internal" href="#getting-cells-from-the-sheets">Getting Cells from the Sheets</a></li>
<li><a class="reference internal" href="#converting-between-column-letters-and-numbers">Converting Between Column Letters and Numbers</a></li>
<li><a class="reference internal" href="#getting-rows-and-columns-from-the-sheets">Getting Rows and Columns from the Sheets</a></li>
<li><a class="reference internal" href="#workbooks-sheets-cells">Workbooks, Sheets, Cells</a><ul>
<li><a class="reference internal" href="#project-reading-data-from-a-spreadsheet">Project: Reading Data from a Spreadsheet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-1-open-spreadsheet-data-sheet">Step 1: Open Spreadsheet Data Sheet</a></li>
<li><a class="reference internal" href="#step-2-populate-the-data-structure">Step 2: Populate the Data Structure</a></li>
<li><a class="reference internal" href="#step-3-write-the-results-to-a-file">Step 3: Write the Results to a File</a></li>
<li><a class="reference internal" href="#tute-ss-ideas-programs">Ideas for Similar Programs</a><ul>
<li><a class="reference internal" href="#writing-spreadsheet-documents">Writing Spreadsheet Documents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-and-saving-spreadsheet-documents">Creating and Saving Spreadsheet Documents</a></li>
<li><a class="reference internal" href="#creating-and-removing-sheets">Creating and Removing Sheets</a></li>
<li><a class="reference internal" href="#writing-values-to-cells">Writing Values to Cells</a><ul>
<li><a class="reference internal" href="#project-updating-a-spreadsheet">Project: Updating a Spreadsheet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-1-set-up-a-data-structure-with-the-update-information">Step 1: Set Up a Data Structure with the Update Information</a></li>
<li><a class="reference internal" href="#step-2-check-all-rows-and-update-incorrect-prices">Step 2: Check All Rows and Update Incorrect Prices</a></li>
<li><a class="reference internal" href="#tute-ss-ideas-simalar-programs">Ideas for Similar Programs</a><ul>
<li><a class="reference internal" href="#setting-the-font-style-of-cells">Setting the Font Style of Cells</a></li>
<li><a class="reference internal" href="#font-objects">Font Objects</a></li>
<li><a class="reference internal" href="#formulas">Formulas</a></li>
<li><a class="reference internal" href="#adjusting-rows-and-columns">Adjusting Rows and Columns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setting-row-height-and-column-width">Setting Row Height and Column Width</a></li>
<li><a class="reference internal" href="#merging-and-unmerging-cells">Merging and Unmerging Cells</a></li>
<li><a class="reference internal" href="#freezing-panes">Freezing Panes</a><ul>
<li><a class="reference internal" href="#charts">Charts</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
<li><a class="reference internal" href="#practice-questions">Practice Questions</a></li>
<li><a class="reference internal" href="#practice-projects">Practice Projects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiplication-table-maker">Multiplication Table Maker</a></li>
<li><a class="reference internal" href="#blank-row-inserter">Blank Row Inserter</a></li>
<li><a class="reference internal" href="#spreadsheet-cell-inverter">Spreadsheet Cell Inverter</a></li>
<li><a class="reference internal" href="#text-files-to-spreadsheet">Text Files to Spreadsheet</a></li>
<li><a class="reference internal" href="#spreadsheet-to-text-files">Spreadsheet to Text Files</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Tute</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">LibreOffice and Python to Work With Excel Spreadsheets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tute_ss.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="libreoffice-and-python-to-work-with-excel-spreadsheets">
<span id="tute-ss"></span><h1>LibreOffice and Python to Work With Excel Spreadsheets<a class="headerlink" href="#libreoffice-and-python-to-work-with-excel-spreadsheets" title="Permalink to this heading"></a></h1>
<figure class="align-center screen-shot invert align-default" id="tute-ss-fig-main-img">
<img alt="Tutorial Image" src="https://user-images.githubusercontent.com/11288701/208299691-79a5b476-dd5c-42e4-927b-982c1213d43b.png" />
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This document is a work in progress and many of the examples are not yet in full working order.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This document is a conversion of “Automate the Boring Stuff with Python” by Al Sweigart, Chapter 13 Working With Excel Spreadsheets <a class="reference external" href="https://automatetheboringstuff.com/2e/chapter13/#calibre_link-437">https://automatetheboringstuff.com/2e/chapter13/#calibre_link-437</a> to LibreOffice and Python.</p>
</div>
<p>Although we don’t often think of spreadsheets as programming tools, almost everyone uses them to organize information into two-dimensional data structures, perform calculations with formulas, and produce output as charts. In this tutorial, we’ll integrate Python into the popular spreadsheet application LibreOffice.</p>
<p>Excel is a popular and powerful spreadsheet application for Windows. The OooDev package allows your Python programs to read and modify Excel spreadsheet files. For example, you might have the boring task of copying certain data from one spreadsheet and pasting it into another one. Or you might have to go through thousands of rows and pick out just a handful of them to make small edits based on some criteria. Or you might have to look through hundreds of spreadsheets of department budgets, searching for any that are in the red. These are exactly the sort of boring, mindless spreadsheet tasks that Python can do for you.</p>
<p>Although Excel is proprietary software from Microsoft, there are free alternatives that run on Windows, macOS, and Linux. Both LibreOffice Calc and OpenOffice Calc work with Excel’s .xlsx file format for spreadsheets, which means the OooDev module can work on spreadsheets from these applications as well. You can download the software from <a class="reference external" href="https://www.libreoffice.org/">https://www.libreoffice.org/</a> and <a class="reference external" href="https://www.openoffice.org/">https://www.openoffice.org/</a>, respectively. Even if you already have Excel installed on your computer, you may find these programs easier to use. The screenshots in this chapter, however, are all from Excel 2010 on Windows 10.</p>
<section id="excel-documents">
<span id="tute-ss-excel-docs"></span><h2>Excel Documents<a class="headerlink" href="#excel-documents" title="Permalink to this heading"></a></h2>
<p>Let’s go over some basic definitions: an Excel spreadsheet document is called a workbook. A single workbook is saved in a file with the .xlsx extension. Each workbook can contain multiple sheets (also called worksheets). The sheet the user is currently viewing (or last viewed before closing Excel) is called the active sheet.</p>
<p>Each sheet has columns (addressed by letters starting at A) and rows (addressed by numbers starting at 1). A box at a particular column and row is called a cell. Each cell can contain a number or text value. The grid of cells with data makes up a sheet.</p>
</section>
<section id="installing-ooodev">
<span id="tute-ss-install-odev"></span><h2>Installing OooDev<a class="headerlink" href="#installing-ooodev" title="Permalink to this heading"></a></h2>
<p>Python does not come with OooDev, so you’ll have to install it. Follow the instructions in <a class="reference external" href="https://python-ooo-dev-tools.readthedocs.io/en/main/index.html#installation">https://python-ooo-dev-tools.readthedocs.io/en/main/index.html#installation</a>.</p>
<p>This is a minimal Windows install example for a virtual environment in the current folder:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-QmF0Y2hmaWxl" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-QmF0Y2hmaWxl" name="QmF0Y2hmaWxl" role="tab" tabindex="0">Batchfile</button><button aria-controls="panel-0-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-0-QmF0Y2hmaWxl" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-QmF0Y2hmaWxl" name="QmF0Y2hmaWxl" role="tabpanel" tabindex="0"><div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>python -m venv .venv
.\.venv\Scripts\activate
pip install oooenv
pip install ooo-dev-tools
oooenv env -t
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-0-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p id="tute-ss-python-libreoffice">Test it:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ooodev</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ooodev</span><span class="o">.</span><span class="n">__version__</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-1-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
</section>
<section id="working-with-python-and-libreoffice">
<span id="id1"></span><h2>Working with Python and LibreOffice<a class="headerlink" href="#working-with-python-and-libreoffice" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python is normally used by running script files, but it is an interpretive language executing line by line. This tutorial uses the REPL, an interactive python shell, so the user can execute a single Python command and get the result. Python normally loads new modules at the top of a listing but in this tutorial they are often loaded as they are needed.</p>
<p>Code in a section often requires code earlier in the section to be executed beforehand but all the required code should be within the section. The names used for objects like the workbook and worksheet vary throughout the sections and a mix of plain arguments and keyword pairs are used.</p>
</div>
<p>Firstly, let us understand how python works with Office. An office instance is required before python can interact with the objects. When the python program is finished it is important to close any document and the Office instance or it will continue to run in the computer stopping other interfaces from starting it. This initialisation and finalisation code is required even if it is not shown in the examples.</p>
<p>Once OooDev is installed, start up a python shell and enter the following code into the REPL:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use the Office API...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Lo.close_doc(wb)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-2-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p class="bg-light-gray blue">As a comparison, elsewhere this might be done in a script with similar code to the following to close the loader and context manager automatically after it runs, even if there is an error:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
   <span class="k">with</span> <span class="n">Lo</span><span class="o">.</span><span class="n">Loader</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
       <span class="c1"># do some work</span>
       <span class="c1"># Lo.close_doc(doc=doc)</span>
   <span class="k">return</span> <span class="mi">0</span>


 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
     <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-3-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Note: Similar commands are used to open with GUI:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-4-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-4-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<section id="reading-excel-documents">
<span id="tute-ss-reading-excel-docs"></span><h3>Reading Excel Documents<a class="headerlink" href="#reading-excel-documents" title="Permalink to this heading"></a></h3>
<p>The examples in this section will use a spreadsheet named <code class="docutils literal notranslate"><span class="pre">example.xlsx</span></code> stored in the root folder.
You can either create the spreadsheet yourself or download it from <a class="reference external" href="https://nostarch.com/automatestuff2/">https://nostarch.com/automatestuff2/</a>.
<code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_office_timeline</span></code> shows the tabs for the three default sheets named <code class="docutils literal notranslate"><span class="pre">Sheet1</span></code>, <code class="docutils literal notranslate"><span class="pre">Sheet2</span></code>, and <code class="docutils literal notranslate"><span class="pre">Sheet3</span></code> that Excel automatically provides for new workbooks.
(The number of default sheets created may vary between operating systems and spreadsheet programs.)</p>
<figure class="align-center diagram invert align-default" id="id7">
<span id="tute-ss-fig-office-timeline"></span><img alt="OpenOffice Timeline Image" src="https://user-images.githubusercontent.com/11288701/208299710-3cfbd875-1d13-43f2-8e62-d93af56fa5f1.png" />
<figcaption>
<p><span class="caption-text">The tabs for a workbook’s sheets are in the lower-left corner of Excel</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Sheet 1 in the example file should look like <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_tbl_sheet_data</span></code>
(If you didn’t download <code class="docutils literal notranslate"><span class="pre">example.xlsx</span></code> from the website, you should enter this data into the sheet yourself).</p>
<p><code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_tbl_sheet_data</span></code>: The <code class="docutils literal notranslate"><span class="pre">example.xlsx</span></code> Spreadsheet</p>
<span id="tute-ss-tbl-sheet-data"></span><table class="docutils align-default" id="sheet-data">
<caption><span class="caption-text">Sheet Data.</span><a class="headerlink" href="#sheet-data" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
<th class="head"><p>C</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>5/04/2015 13:34</p></td>
<td><p>Apples</p></td>
<td><p>73</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>5/04/2015 3:41</p></td>
<td><p>Cherries</p></td>
<td><p>85</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>6/04/2015 12:46</p></td>
<td><p>Pears</p></td>
<td><p>14</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>8/04/2015 8:59</p></td>
<td><p>Oranges</p></td>
<td><p>52</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>10/04/2015 2:07</p></td>
<td><p>Apples</p></td>
<td><p>152</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>10/04/2015 18:10</p></td>
<td><p>Bananas</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>10/04/2015 2:40</p></td>
<td><p>Strawberries</p></td>
<td><p>98</p></td>
</tr>
</tbody>
</table>
<p>Now that we have our example spreadsheet, let’s see how we can manipulate it with the OooDev package.</p>
</section>
</section>
<section id="opening-excel-documents-with-ooodev">
<span id="tute-ss-open-excel-doc-odev"></span><h2>Opening Excel Documents with OooDev<a class="headerlink" href="#opening-excel-documents-with-ooodev" title="Permalink to this heading"></a></h2>
<p>Once you’ve installed the OooDev package, you’ll be able to use the Calc class. Enter the following into a new interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-5-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">open_doc</span><span class="p">(</span><span class="s1">&#39;example.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">&lt;class &#39;pyuno&#39;&gt;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-5-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The Calc.open_doc() class takes in the filename and returns a value of the workbook data type.
This Workbook object represents the Excel file, a bit like how a File object represents an opened text file.</p>
<p>Remember that example.xlsx needs to be in the current working directory in order for you to work with it.
You can find out what the current working directory is by importing os and using os.getcwd(), and you can change the current working directory using os.chdir().</p>
</section>
<section id="getting-sheets-from-the-workbook">
<span id="tute-ss-get-sheet-wb"></span><h2>Getting Sheets from the Workbook<a class="headerlink" href="#getting-sheets-from-the-workbook" title="Permalink to this heading"></a></h2>
<p>You can get a list of all the sheet names in the workbook by accessing the sheetnames property.
Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-6-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_names</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">(&#39;Sheet1&#39;, &#39;Sheet2&#39;, &#39;Sheet3&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_name</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
<span class="go">&#39;Sheet3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws2</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_active_sheet</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_name</span><span class="p">(</span><span class="n">ws2</span><span class="p">)</span>
<span class="go">&#39;Sheet1&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-6-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Each sheet is represented by a Worksheet object and you can use the Calc class to return it’s properties.
<code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet_names()</span></code> will return all sheets in the workbook given as an argument.
A particular Worksheet object is returned using <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code> with the Workbook and sheet name string as arguments, and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc/get_sheet_name()</span></code> with a Worksheet object argument returns teh Worksheet name.
Finally, you can use <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_active_sheet()</span></code> of a Workbook object to get the workbook’s active sheet, and from there the name.
The active sheet is the sheet that is displayed when the workbook is opened on your computer.</p>
</section>
<section id="getting-cells-from-the-sheets">
<span id="tute-ss-get-sheet-cells"></span><h2>Getting Cells from the Sheets<a class="headerlink" href="#getting-cells-from-the-sheets" title="Permalink to this heading"></a></h2>
<p>Once you have a Worksheet object, you can access a Cell object using the Calc class. Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-7-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-7-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-7-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.date_time_util</span> <span class="kn">import</span> <span class="n">DateUtil</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">open_doc</span><span class="p">(</span><span class="s1">&#39;example.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;A1&quot;</span><span class="p">)</span>
<span class="go">42099.565300925926</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DateUtil</span><span class="o">.</span><span class="n">date_from_number</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;A1&quot;</span><span class="p">))</span>
<span class="go">datetime.datetime(2015, 4, 5, 13, 34, 2, tzinfo=datetime.timezone.utc)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">DateUtil</span><span class="o">.</span><span class="n">date_from_number</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;A1&quot;</span><span class="p">)))</span>
<span class="go">&#39;2015-04-05 13:34:02+00:00&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;B1&quot;</span><span class="p">)</span>
<span class="go">&#39;Apples&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_cell</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="s2">&quot;B1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;Row </span><span class="si">%s</span><span class="s1">, Column </span><span class="si">%s</span><span class="s1"> is </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_cell_address</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">Row</span><span class="p">,</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_cell_address</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">Column</span><span class="p">,</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="go">&#39;Row 0, Column 1 is Apples&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="go">73.0</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-7-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The Cell object has a value property that contains, unsurprisingly, the value stored in that cell.
There are many ways of referencing Cell objects, using the cell object, or the sheet with: cell address, cell name also have row, column, and coordinate properties that provide location information for the cell.</p>
<p>OooDev returns dates as float so they need to be formatted to display the date in the required format.</p>
<p>Here, accessing the value property of our Cell object for cell <code class="docutils literal notranslate"><span class="pre">B1</span></code> gives us the string <code class="docutils literal notranslate"><span class="pre">Apples</span></code>.
The row property gives us the integer <code class="docutils literal notranslate"><span class="pre">1</span></code>, the column property gives us <code class="docutils literal notranslate"><span class="pre">B</span></code>, and the coordinate property gives us <code class="docutils literal notranslate"><span class="pre">B1</span></code>.</p>
<p>Specifying a column by letter can be tricky to program, especially because after column <code class="docutils literal notranslate"><span class="pre">Z</span></code>, the columns start by using two letters: <code class="docutils literal notranslate"><span class="pre">AA</span></code>, <code class="docutils literal notranslate"><span class="pre">AB</span></code>, <code class="docutils literal notranslate"><span class="pre">AC</span></code>, and so on.
As an alternative, you can also get a cell using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.get_cell()</span></code> method and passing integers for its row and column keyword arguments.
The first row or column integer is <code class="docutils literal notranslate"><span class="pre">0</span></code>, not <code class="docutils literal notranslate"><span class="pre">1</span></code>.
Continue the interactive shell example by entering the following:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-8-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-8-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-8-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-8-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_cell</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="s2">&quot;B1&quot;</span><span class="p">))</span>
<span class="go">&#39;Apples&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_cell</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&#39;Apples&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="c1"># Go through every other row:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_cell</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)))</span>
<span class="gp">...</span>
<span class="go">1 Apples</span>
<span class="go">3 Pears</span>
<span class="go">5 Apples</span>
<span class="go">7 Strawberries</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-8-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>As you can see, using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.get_cell()</span></code> method and passing it <code class="docutils literal notranslate"><span class="pre">column=1</span></code> and <code class="docutils literal notranslate"><span class="pre">row=0</span></code> gets you a Cell object for cell <code class="docutils literal notranslate"><span class="pre">B1</span></code>, just like specifying <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_cell()</span></code> with ‘B1’ did.
Then, using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_val()</span></code> method and its keyword arguments, you can write a for loop to print the values of a series of cells.</p>
<p>Say you want to go down column <code class="docutils literal notranslate"><span class="pre">B</span></code> and print the value in every cell with an odd row number.
By passing <code class="docutils literal notranslate"><span class="pre">2</span></code> for the <code class="docutils literal notranslate"><span class="pre">range()</span></code> function’s “step” parameter, you can get cells from every second row (in this case, all the odd-numbered rows).
The for loop’s <code class="docutils literal notranslate"><span class="pre">i</span></code> variable is passed for the row keyword argument to the <code class="docutils literal notranslate"><span class="pre">cell()</span></code> method, while <code class="docutils literal notranslate"><span class="pre">2</span></code> is always passed for the column keyword argument.
Note that the integer <code class="docutils literal notranslate"><span class="pre">2</span></code>, not the string <code class="docutils literal notranslate"><span class="pre">B</span></code>, is passed.</p>
<p>You can determine the size of the sheet with the Worksheet object’s max_row and max_column properties.
Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-9-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-9-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-9-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-9-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">find_used_range</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_range_str</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span>
<span class="go">&#39;A1:C7&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_address</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span>
<span class="go">(com.sun.star.table.CellRangeAddress){ Sheet = (short)0x0, StartColumn = (long)0x0, StartRow = (long)0x0, EndColumn = (long)0x2, EndRow = (long)0x6 }</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_address</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span><span class="o">.</span><span class="n">EndRow</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_address</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span><span class="o">.</span><span class="n">EndColumn</span>
<span class="go">2</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-9-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Note that the max_column property is an integer rather than the letter that appears in Excel.</p>
</section>
<section id="converting-between-column-letters-and-numbers">
<span id="tute-ss-letter-number"></span><h2>Converting Between Column Letters and Numbers<a class="headerlink" href="#converting-between-column-letters-and-numbers" title="Permalink to this heading"></a></h2>
<p>To convert from letters to numbers, use the <code class="xref py py-class docutils literal notranslate"><span class="pre">TableHelper</span></code> class with the <code class="xref py py-meth docutils literal notranslate"><span class="pre">col_name_to_int()</span></code> method.
To convert from numbers to letters, use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">make_column_name()</span></code> method.
Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-10-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-10-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-10-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-10-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-10-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.table_helper</span> <span class="kn">import</span> <span class="n">TableHelper</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TableHelper</span><span class="o">.</span><span class="n">col_name_to_int</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1"># Get A&#39;s number.</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TableHelper</span><span class="o">.</span><span class="n">col_name_to_int</span><span class="p">(</span><span class="s1">&#39;AA&#39;</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TableHelper</span><span class="o">.</span><span class="n">make_column_name</span><span class="p">(</span><span class="mi">85</span><span class="p">)</span>
<span class="go">&#39;CG&#39;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-10-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>After you import the <code class="xref py py-class docutils literal notranslate"><span class="pre">TableHelper</span></code> class from OooDev , you can use <code class="xref py py-meth docutils literal notranslate"><span class="pre">make_column_name()</span></code> and pass it an integer like <code class="docutils literal notranslate"><span class="pre">27</span></code> to figure out what the letter name of the <code class="docutils literal notranslate"><span class="pre">27th</span></code> column is.
The function <code class="xref py py-meth docutils literal notranslate"><span class="pre">column_index_string()</span></code> does the reverse: you pass it the letter name of a column, and it tells you what number that column is. You don’t need to have a workbook loaded to use these functions. If you want, you can load a workbook, get a Worksheet object, and use a Worksheet property like max_column to get an integer. Then, you can pass that integer to get_column_letter().</p>
</section>
<section id="getting-rows-and-columns-from-the-sheets">
<span id="tute-ss-rows-cols-sheet"></span><h2>Getting Rows and Columns from the Sheets<a class="headerlink" href="#getting-rows-and-columns-from-the-sheets" title="Permalink to this heading"></a></h2>
<p>You can slice Worksheet objects to get all the Cell objects in a row, column, or rectangular area of the spreadsheet.
Then you can loop over all the cells in the slice. Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-11-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-11-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-11-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-11-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-11-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">range_name</span><span class="o">=</span><span class="s2">&quot;A1:C3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">((42099.565300925926, &#39;Apples&#39;, 73.0), (42099.15373842593, &#39;Cherries&#39;, 85.0), (42100.532534722224, &#39;Pears&#39;, 14.0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">column_number_str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- END OF ROW ---&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">A1 42099.565300925926</span>
<span class="go">B1 Apples</span>
<span class="go">C1 73.0</span>
<span class="go">--- END OF ROW ---</span>
<span class="go">A2 42099.15373842593</span>
<span class="go">B2 Cherries</span>
<span class="go">C2 85.0</span>
<span class="go">--- END OF ROW ---</span>
<span class="go">A3 42100.532534722224</span>
<span class="go">B3 Pears</span>
<span class="go">C3 14.0</span>
<span class="go">--- END OF ROW ---</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-11-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Here, we specify that we want the Cell objects in the rectangular area from <code class="docutils literal notranslate"><span class="pre">A1</span></code> to <code class="docutils literal notranslate"><span class="pre">C3</span></code>, and we get a Generator object containing the Cell objects in that area.
To help us visualize this Generator object, we can use <code class="docutils literal notranslate"><span class="pre">tuple()</span></code> on it to display its Cell objects in a tuple, alternatively use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.print_array()</span></code>.</p>
<p>This tuple contains three tuples: one for each row, from the top of the desired area to the bottom.
Each of these three inner tuples contains the Cell objects in one row of our desired area, from the leftmost cell to the right.
So overall, our slice of the sheet contains all the Cell objects in the area from <code class="docutils literal notranslate"><span class="pre">A1</span></code> to <code class="docutils literal notranslate"><span class="pre">C3</span></code>, starting from the top-left cell and ending with the bottom-right cell.</p>
<p>To print the values of each cell in the area, we use two for loops.
The outer for loop goes over each row in the slice.
Then, for each row, the nested for loop goes through each cell in that row.</p>
<p>To access the values of cells in a particular row or column, you can also use a Worksheet object’s rows and columns interface.
These properties must be converted to lists with the <code class="docutils literal notranslate"><span class="pre">list()</span></code> function before you can use the square brackets and an index with them.
Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-12-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-12-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-12-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-12-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-12-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_col</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[&#39;Apples&#39;, &#39;Cherries&#39;, &#39;Pears&#39;, &#39;Oranges&#39;, &#39;Apples&#39;, &#39;Bananas&#39;, &#39;Strawberries&#39;]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-12-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Using the rows property on a Worksheet object will give you a tuple of tuples.
Each of these inner tuples represents a row, and contains the Cell objects in that row.
The columns property also gives you a tuple of tuples, with each of the inner tuples containing the Cell objects in a particular column.
For <code class="docutils literal notranslate"><span class="pre">example.xlsx</span></code>, since there are <code class="docutils literal notranslate"><span class="pre">7</span></code> rows and <code class="docutils literal notranslate"><span class="pre">3</span></code> columns, rows gives us a tuple of <code class="docutils literal notranslate"><span class="pre">7</span></code> tuples (each containing <code class="docutils literal notranslate"><span class="pre">3</span></code> Cell objects), and columns gives us a tuple of <code class="docutils literal notranslate"><span class="pre">3</span></code> tuples (each containing <code class="docutils literal notranslate"><span class="pre">7</span></code> Cell objects).</p>
<p>To access one particular tuple, you can refer to it by its index in the larger tuple.
For example, to get the tuple that represents column <code class="docutils literal notranslate"><span class="pre">B</span></code>, you use <code class="docutils literal notranslate"><span class="pre">list(sheet.columns)[1]</span></code>.
To get the tuple containing the Cell objects in column A, you’d use <code class="docutils literal notranslate"><span class="pre">list(sheet.columns)[0]</span></code>.
Once you have a tuple representing one row or column, you can loop through its Cell objects and print their values.</p>
</section>
<section id="workbooks-sheets-cells">
<span id="tute-ss-wb-sheet-cells"></span><h2>Workbooks, Sheets, Cells<a class="headerlink" href="#workbooks-sheets-cells" title="Permalink to this heading"></a></h2>
<p>As a quick review, here’s a rundown of all the functions, methods, and data types involved in reading a cell out of a spreadsheet file:</p>
<div class="line-block">
<div class="line">Import the OooDev modules.</div>
<div class="line">Get a Workbook object.</div>
<div class="line">Use the active or sheetnames properties.</div>
<div class="line">Get a Worksheet object.</div>
<div class="line">Use indexing or the cell() sheet method with row and column keyword arguments.</div>
<div class="line">Get a Cell object.</div>
<div class="line">Read the Cell object’s value property.</div>
</div>
<p>This section is finished so close the doc and office:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-13-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-13-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-13-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-13-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-13-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-13-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<section id="project-reading-data-from-a-spreadsheet">
<span id="tute-ss-proj-read-data-sheet"></span><h3>Project: Reading Data from a Spreadsheet<a class="headerlink" href="#project-reading-data-from-a-spreadsheet" title="Permalink to this heading"></a></h3>
<p>Say you have a spreadsheet of data from the 2010 US Census and you have the boring task of going through its thousands of rows to count both the total population and the number of census tracts for each county.
(A census tract is simply a geographic area defined for the purposes of the census.)
Each row represents a single census tract. We’ll name the spreadsheet file <code class="docutils literal notranslate"><span class="pre">censuspopdata.xlsx</span></code>, and you can download it from <a class="reference external" href="https://nostarch.com/automatestuff2/">https://nostarch.com/automatestuff2/</a>.
Its contents look like <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_censuspopdata_sht</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id8">
<span id="tute-ss-fig-censuspopdata-sht"></span><img alt="The censuspopdata.xlsx spreadsheet" src="https://user-images.githubusercontent.com/11288701/208299730-026a12e8-1105-4637-ad7b-13914a247fc7.png" />
<figcaption>
<p><span class="caption-text">:The <code class="docutils literal notranslate"><span class="pre">censuspopdata.xlsx</span></code> spreadsheet</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Even though Excel can calculate the sum of multiple selected cells, you’d still have to select the cells for each of the 3,000-plus counties.
Even if it takes just a few seconds to calculate a county’s population by hand, this would take hours to do for the whole spreadsheet.</p>
<p>In this project, you’ll write a script that can read from the census spreadsheet file and calculate statistics for each county in a matter of seconds.</p>
<p>This is what your program does:</p>
<ul class="ul-list simple">
<li><p>Reads the data from the Excel spreadsheet</p></li>
<li><p>Counts the number of census tracts in each county</p></li>
<li><p>Counts the total population of each county</p></li>
<li><p>Prints the results</p></li>
</ul>
<p>This means your code will need to do the following:</p>
<ul class="ul-list simple">
<li><p>Open and read the cells of an Excel document with OooDev modules</p></li>
<li><p>Calculate all the tract and population data and store it in a data structure</p></li>
<li><p>Write the data structure to a text file with the <code class="docutils literal notranslate"><span class="pre">.py</span></code> extension using the pprint module</p></li>
</ul>
</section>
</section>
<section id="step-1-open-spreadsheet-data-sheet">
<span id="tute-ss-step-read-sheet-data"></span><h2>Step 1: Open Spreadsheet Data Sheet<a class="headerlink" href="#step-1-open-spreadsheet-data-sheet" title="Permalink to this heading"></a></h2>
<p>There is just one sheet in the <code class="docutils literal notranslate"><span class="pre">censuspopdata.xlsx</span></code> spreadsheet, named ‘Population by Census Tract’.</p>
<p>Enter the following code into the REPL:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-14-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-14-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-14-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-14-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-14-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># readCensusExcel.py - Tabulates population and number of census tracts for</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># each county.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Opening workbook...&#39;</span><span class="p">)</span>
<span class="go">Opening workbook...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">open_doc</span><span class="p">(</span><span class="s1">&#39;censuspopdata.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Population by Census Tract&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">county_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Fill in county_data with each county&#39;s population and tracts.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Iterate over the rows.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Open a new text file and write the contents of county_data to it.</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-14-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>This code imports the OooDev modules, as well as the <code class="docutils literal notranslate"><span class="pre">pprint</span></code> module that you’ll use to print the final county data.
Then it opens the <code class="docutils literal notranslate"><span class="pre">censuspopdata.xlsx</span></code> file, and gets the sheet with the census data.</p>
<p>Note that you’ve also created a variable named <code class="docutils literal notranslate"><span class="pre">county_data</span></code>, which will contain the populations and number of tracts you calculate for each county.
Before you can store anything in it, though, you should determine exactly how you’ll structure the data inside it.</p>
</section>
<section id="step-2-populate-the-data-structure">
<span id="tute-ss-step-pop-data-structure"></span><h2>Step 2: Populate the Data Structure<a class="headerlink" href="#step-2-populate-the-data-structure" title="Permalink to this heading"></a></h2>
<p>Each row in the sheet holds the data for a single census tract.
The columns are the tract number <code class="docutils literal notranslate"><span class="pre">A</span></code>, the state abbreviation <code class="docutils literal notranslate"><span class="pre">B</span></code>, the county name <code class="docutils literal notranslate"><span class="pre">C</span></code>, and the population of the tract <code class="docutils literal notranslate"><span class="pre">D</span></code>.</p>
<p>Reading the spreadsheet data requires iterating through each row.
Let’s look at the original sample code below converted for OooDev but don’t enter it into the REPL:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-15-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-15-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-15-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-15-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-15-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reading rows...&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_row_used_last_index</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span>
    <span class="c1"># Each row in the spreadsheet has data for one census tract.</span>
    <span class="n">state</span>  <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
    <span class="n">county</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
    <span class="n">pop</span>    <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-15-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>This is a big spreadsheet. Iterating through the rows for the required cells getting and setting the cell value is incredibly slow.
It is much more efficient to read the whole range into an array, update the array, and write the array.</p>
<p>The following code reads the data into the <code class="docutils literal notranslate"><span class="pre">data</span></code> array and iterates through the array to load data for each tract:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-16-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-16-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-16-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-16-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-16-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;B2:D&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_row_used_last_index</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># print(range_name)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">range_name</span><span class="o">=</span><span class="n">range_name</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reading rows...&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># Each row in the spreadsheet has data for one census tract.</span>
    <span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">pop</span> <span class="o">=</span> <span class="n">row</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-16-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The data structure stored in <code class="docutils literal notranslate"><span class="pre">county_data</span></code> will be a dictionary with state abbreviations as its keys.
Each state abbreviation will map to another dictionary, whose keys are strings of the county names in that state.
Each county name will in turn map to a dictionary with just two keys, <code class="docutils literal notranslate"><span class="pre">tracts</span></code> and <code class="docutils literal notranslate"><span class="pre">pop</span></code>.
These keys map to the number of census tracts and population for the county.
For example, the dictionary will look similar to this:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-17-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-17-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-17-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-17-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-17-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;AK&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Aleutians East&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="mi">3141</span><span class="p">,</span> <span class="s1">&#39;tracts&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s1">&#39;Aleutians West&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="mi">5561</span><span class="p">,</span> <span class="s1">&#39;tracts&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
        <span class="s1">&#39;Anchorage&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="mi">291826</span><span class="p">,</span> <span class="s1">&#39;tracts&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">},</span>
        <span class="s1">&#39;Bethel&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="mi">17013</span><span class="p">,</span> <span class="s1">&#39;tracts&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
        <span class="s1">&#39;Bristol Bay&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="mi">997</span><span class="p">,</span> <span class="s1">&#39;tracts&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-17-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>If the previous dictionary were stored in <code class="docutils literal notranslate"><span class="pre">county_data</span></code>, the following expressions would evaluate like this:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-18-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-18-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-18-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-18-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-18-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">county_data</span><span class="p">[</span><span class="s1">&#39;AK&#39;</span><span class="p">][</span><span class="s1">&#39;Anchorage&#39;</span><span class="p">][</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
<span class="go">291826</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">county_data</span><span class="p">[</span><span class="s1">&#39;AK&#39;</span><span class="p">][</span><span class="s1">&#39;Anchorage&#39;</span><span class="p">][</span><span class="s1">&#39;tracts&#39;</span><span class="p">]</span>
<span class="go">55</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-18-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>More generally, the <code class="docutils literal notranslate"><span class="pre">county_data</span></code> dictionary’s keys will look like this:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-19-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-19-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-19-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-19-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-19-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">county_data</span><span class="p">[</span><span class="n">state</span> <span class="n">abbrev</span><span class="p">][</span><span class="n">county</span><span class="p">][</span><span class="s1">&#39;tracts&#39;</span><span class="p">]</span>
<span class="n">county_data</span><span class="p">[</span><span class="n">state</span> <span class="n">abbrev</span><span class="p">][</span><span class="n">county</span><span class="p">][</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-19-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Now that you know how <code class="docutils literal notranslate"><span class="pre">county_data</span></code> will be structured, you can write the code that will fill it with the county data. Add the following code to the bottom of your program:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-20-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-20-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-20-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-20-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-20-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;B2:D&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_row_used_last_index</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># print(range_name)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">range_name</span><span class="o">=</span><span class="n">range_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reading rows...&#39;</span><span class="p">)</span>
<span class="go">Reading rows...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="c1"># Each row in the spreadsheet has data for one census tract.</span>
<span class="gp">... </span>    <span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">pop</span> <span class="o">=</span> <span class="n">row</span>
<span class="gp">... </span>    <span class="c1"># Make sure the key for this state exists.</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">county_data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">... </span>    <span class="c1"># Make sure the key for this county in this state exists.</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">county_data</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">county</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;tracts&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="gp">... </span>    <span class="c1"># Each row represents one census tract, so increment by one.</span>
<span class="gp">... </span>    <span class="n">county_data</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">county</span><span class="p">][</span><span class="s1">&#39;tracts&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="c1"># Increase the county pop by the pop in this census tract.</span>
<span class="gp">... </span>    <span class="n">county_data</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">county</span><span class="p">][</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-20-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The code gets the range for the census data and loads it into a <code class="docutils literal notranslate"><span class="pre">data</span></code> array.
It then iterates through the rows</p>
<p>The last two lines of code perform the actual calculation work, incrementing the value for tracts and increasing the value for pop for the current county on each iteration of the for loop.</p>
<p>The other code is there because you cannot add a county dictionary as the value for a state abbreviation key until the key itself exists in <code class="docutils literal notranslate"><span class="pre">county_data</span></code>
(that is, <code class="docutils literal notranslate"><span class="pre">county_data['AK']['Anchorage']['tracts']</span> <span class="pre">+=</span> <span class="pre">1</span></code> will cause an error if the <code class="docutils literal notranslate"><span class="pre">AK</span></code> key doesn’t exist yet).
To make sure the state abbreviation key exists in your data structure, you need to call the <code class="docutils literal notranslate"><span class="pre">setdefault()</span></code> method to set a value if one does not already exist for state.</p>
<p>Just as the county_data dictionary needs a dictionary as the value for each state abbreviation key, each of those dictionaries will need its own dictionary as the value for each county key.
And each of those dictionaries in turn will need keys <code class="docutils literal notranslate"><span class="pre">tracts</span></code> and <code class="docutils literal notranslate"><span class="pre">pop</span></code> that start with the integer value <code class="docutils literal notranslate"><span class="pre">0</span></code>
(if you ever lose track of the dictionary structure, look back at the example dictionary at the start of this section).</p>
<p>Since <code class="docutils literal notranslate"><span class="pre">setdefault()</span></code> will do nothing if the key already exists, you can call it on every iteration of the for loop without a problem.</p>
</section>
<section id="step-3-write-the-results-to-a-file">
<span id="tute-ss-step-write-file"></span><h2>Step 3: Write the Results to a File<a class="headerlink" href="#step-3-write-the-results-to-a-file" title="Permalink to this heading"></a></h2>
<p>After the for loop has finished, the <code class="docutils literal notranslate"><span class="pre">county_data</span></code> dictionary will contain all of the population and tract information keyed by county and state.
At this point, you could program more code to write this to a text file or another Excel spreadsheet.
For now, let’s just use the <code class="docutils literal notranslate"><span class="pre">pprint.pformat()</span></code> function to write the <code class="docutils literal notranslate"><span class="pre">county_data</span></code> dictionary value as a massive string to a file named <code class="docutils literal notranslate"><span class="pre">census2010.py</span></code>.
Add the following code to the bottom of your program (making sure to keep it unindented so that it stays outside the for loop):</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-21-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-21-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-21-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-21-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-21-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Open a new text file and write the contents of county_data to it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writing results...&#39;</span><span class="p">)</span>
<span class="go">Writing results...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;census2010.py&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;allData = &#39;</span> <span class="o">+</span> <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">county_data</span><span class="p">))</span>
<span class="go">152237</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
<span class="go">Done.</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-21-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The <code class="docutils literal notranslate"><span class="pre">pprint.pformat()</span></code> function produces a string that itself is formatted as valid Python code.
By outputting it to a text file named <code class="docutils literal notranslate"><span class="pre">census2010.py</span></code>, you’ve generated a Python program from your Python program!
This may seem complicated, but the advantage is that you can now import <code class="docutils literal notranslate"><span class="pre">census2010.py</span></code> just like any other Python module.
In the interactive shell, change the current working directory to the folder with your newly created <code class="docutils literal notranslate"><span class="pre">census2010.py</span></code> file and then import it:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-22-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-22-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-22-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-22-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-22-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">census2010</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">census2010</span><span class="o">.</span><span class="n">allData</span><span class="p">[</span><span class="s1">&#39;AK&#39;</span><span class="p">][</span><span class="s1">&#39;Anchorage&#39;</span><span class="p">]</span>
<span class="go">{&#39;pop&#39;: 291826, &#39;tracts&#39;: 55}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anchoragePop</span> <span class="o">=</span> <span class="n">census2010</span><span class="o">.</span><span class="n">allData</span><span class="p">[</span><span class="s1">&#39;AK&#39;</span><span class="p">][</span><span class="s1">&#39;Anchorage&#39;</span><span class="p">][</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The 2010 population of Anchorage was &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">anchoragePop</span><span class="p">))</span>
<span class="go">The 2010 population of Anchorage was 291826</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-22-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The <code class="docutils literal notranslate"><span class="pre">readCensusExcel.py</span></code> program was throwaway code: once you have its results saved to <code class="docutils literal notranslate"><span class="pre">census2010.py</span></code>, you won’t need to run the program again.
Whenever you need the county data, you can just run <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">census2010</span></code>.</p>
<p>Calculating this data by hand would have taken hours; this program did it in a few seconds.
Using OooDev, you will have no trouble extracting information that is saved to an Excel spreadsheet and performing calculations on it.
The complete program is given below:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-23-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-23-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-23-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-23-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-23-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># readCensusExcel.py - Tabulates population and number of census tracts for</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># each county.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Opening workbook...&#39;</span><span class="p">)</span>
<span class="go">Opening workbook...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">open_doc</span><span class="p">(</span><span class="s1">&#39;censuspopdata.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Population by Census Tract&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">county_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;B2:D&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_row_used_last_index</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># print(range_name)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">range_name</span><span class="o">=</span><span class="n">range_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reading rows...&#39;</span><span class="p">)</span>
<span class="go">Reading rows...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="c1"># Each row in the spreadsheet has data for one census tract.</span>
<span class="gp">... </span>    <span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">pop</span> <span class="o">=</span> <span class="n">row</span>
<span class="gp">... </span>    <span class="c1"># Make sure the key for this state exists.</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">county_data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">... </span>    <span class="c1"># Make sure the key for this county in this state exists.</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">county_data</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">county</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;tracts&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="gp">... </span>    <span class="c1"># Each row represents one census tract, so increment by one.</span>
<span class="gp">... </span>    <span class="n">county_data</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">county</span><span class="p">][</span><span class="s1">&#39;tracts&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="c1"># Increase the county pop by the pop in this census tract.</span>
<span class="gp">... </span>    <span class="n">county_data</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">county</span><span class="p">][</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Open a new text file and write the contents of county_data to it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writing results...&#39;</span><span class="p">)</span>
<span class="go">Writing results...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;census2010B.py&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;allData = &#39;</span> <span class="o">+</span> <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">county_data</span><span class="p">))</span>
<span class="go">152237</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
<span class="go">Done.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">census2010</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">census2010</span><span class="o">.</span><span class="n">allData</span><span class="p">[</span><span class="s1">&#39;AK&#39;</span><span class="p">][</span><span class="s1">&#39;Anchorage&#39;</span><span class="p">]</span>
<span class="go">{&#39;pop&#39;: 291826, &#39;tracts&#39;: 55}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anchoragePop</span> <span class="o">=</span> <span class="n">census2010</span><span class="o">.</span><span class="n">allData</span><span class="p">[</span><span class="s1">&#39;AK&#39;</span><span class="p">][</span><span class="s1">&#39;Anchorage&#39;</span><span class="p">][</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The 2010 population of Anchorage was &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">anchoragePop</span><span class="p">))</span>
<span class="go">The 2010 population of Anchorage was 291826</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-23-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
</section>
<section id="tute-ss-ideas-programs">
<span id="ideas-for-similar-programs"></span><h2>Ideas for Similar Programs<a class="headerlink" href="#tute-ss-ideas-programs" title="Permalink to this heading"></a></h2>
<p>Many businesses and offices use Excel to store various types of data, and it’s not uncommon for spreadsheets to become large and unwieldy.
Any program that parses an Excel spreadsheet has a similar structure: it loads the spreadsheet file, preps some variables or data structures, and then loops through each of the rows in the spreadsheet.
Such a program could do the following:</p>
<ul class="ul-list simple">
<li><p>Compare data across multiple rows in a spreadsheet.</p></li>
<li><p>Open multiple Excel files and compare data between spreadsheets.</p></li>
<li><p>Check whether a spreadsheet has blank rows or invalid data in any cells and alert the user if it does.</p></li>
<li><p>Read data from a spreadsheet and use it as the input for your Python programs.</p></li>
</ul>
<section id="writing-spreadsheet-documents">
<span id="tute-ss-writing-sheet-docs"></span><h3>Writing Spreadsheet Documents<a class="headerlink" href="#writing-spreadsheet-documents" title="Permalink to this heading"></a></h3>
<p>OooDev also provides ways of writing data, meaning that your programs can create and edit spreadsheet files.
With Python, it’s simple to create spreadsheets with thousands of rows of data.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-24-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-24-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-24-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-24-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-24-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use the Office API... NOTE: Following line raises an error</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Lo.close_doc(wb)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-24-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
</section>
</section>
<section id="creating-and-saving-spreadsheet-documents">
<span id="tute-ss-create-save-sheet-docs"></span><h2>Creating and Saving Spreadsheet Documents<a class="headerlink" href="#creating-and-saving-spreadsheet-documents" title="Permalink to this heading"></a></h2>
<p>Start a lo instance and use the Calc create_doc class to create a new, blank Workbook object.
Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-25-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-25-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-25-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-25-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-25-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_name</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
<span class="go">&#39;Sheet1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_sheet_name</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="s1">&#39;Spam Bacon Eggs Sheet&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_name</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
<span class="go">&#39;Spam Bacon Eggs Sheet&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_names</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">(&#39;Spam Bacon Eggs Sheet&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="s2">&quot;foo.xlsx&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-25-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The workbook will start off with a single sheet named Sheet.
You can change the name of the sheet using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.set_sheet_name()</span></code> method which stores a new string in its title property.</p>
<p>Any time you modify the Workbook object or its sheets and cells, the spreadsheet file will not be saved until you call the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.save_doc()</span></code> workbook method.
Enter the following into the interactive shell (with <code class="docutils literal notranslate"><span class="pre">example.xlsx</span></code> in the current working directory):</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-26-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-26-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-26-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-26-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-26-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">open_doc</span><span class="p">(</span><span class="s1">&#39;example.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_sheet_name</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="s1">&#39;Spam Spam Spam&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="s1">&#39;example_copy.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-26-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Here, we change the name of our sheet. To save our changes, we pass a filename as a string to the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.save_doc()</span></code> method.
Passing a different filename than the original, such as <code class="docutils literal notranslate"><span class="pre">example_copy.xlsx</span></code>, saves the changes to a copy of the spreadsheet.</p>
<p>Whenever you edit a spreadsheet you’ve loaded from a file, you should always save the new, edited spreadsheet to a different filename than the original.
That way, you’ll still have the original spreadsheet file to work with in case a bug in your code caused the new, saved file to have incorrect or corrupt data.</p>
</section>
<section id="creating-and-removing-sheets">
<span id="tute-ss-create-remove-shts"></span><h2>Creating and Removing Sheets<a class="headerlink" href="#creating-and-removing-sheets" title="Permalink to this heading"></a></h2>
<p>Sheets can be added to and removed from a workbook with the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.insert_sheet()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.remove_sheet()</span></code> methods.
Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-27-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-27-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-27-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-27-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-27-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="go">Creating Office document scalc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_names</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">(&#39;Sheet1&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">insert_sheet</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="s1">&#39;Sheet2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_names</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">(&#39;Sheet1&#39;, &#39;Sheet2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">insert_sheet</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="s1">&#39;First Sheet&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_names</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">(&#39;First Sheet&#39;, &#39;Sheet1&#39;, &#39;Sheet2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">insert_sheet</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="s1">&#39;Middle Sheet&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_names</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">(&#39;First Sheet&#39;, &#39;Sheet1&#39;, &#39;Middle Sheet&#39;, &#39;Sheet2&#39;)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-27-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.insert_sheet()</span></code> method returns a new Worksheet object named <code class="docutils literal notranslate"><span class="pre">SheetX</span></code>, which by default is set to be the last sheet in the workbook.
Optionally, the name and index of the new sheet can be specified with the name and index keyword arguments.</p>
<p>Continue the previous example by entering the following:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-28-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-28-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-28-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-28-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-28-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_names</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">(&#39;First Sheet&#39;, &#39;Sheet1&#39;, &#39;Middle Sheet&#39;, &#39;Sheet2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">remove_sheet</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="s1">&#39;Middle Sheet&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">remove_sheet</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="s1">&#39;Sheet2&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet_names</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="go">(&#39;First Sheet&#39;, &#39;Sheet1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-28-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>You can use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.remove_sheet()</span></code> method to remove a sheet from a workbook, similarly to deleting a key-value pair from a dictionary.</p>
<p>Remember to call the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.save_doc()</span></code> method to save the changes after adding sheets to or removing sheets from the workbook.</p>
</section>
<section id="writing-values-to-cells">
<span id="tute-ss-vals-cells"></span><h2>Writing Values to Cells<a class="headerlink" href="#writing-values-to-cells" title="Permalink to this heading"></a></h2>
<p>Writing values to cells is much like writing values to keys in a dictionary.
Enter this into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-29-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-29-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-29-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-29-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-29-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="go">Creating Office document scalc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;Hello, world!&#39;</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">get_string</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello, world!&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-29-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>If you have the cell’s coordinate as a string, you can use it just like a dictionary key on the Worksheet object to specify which cell to write to.</p>
<section id="project-updating-a-spreadsheet">
<span id="tute-ss-updating-sheet"></span><h3>Project: Updating a Spreadsheet<a class="headerlink" href="#project-updating-a-spreadsheet" title="Permalink to this heading"></a></h3>
<p>In this project, you’ll write a program to update cells in a spreadsheet of produce sales.
Your program will look through the spreadsheet, find specific kinds of produce, and update their prices.
Download this spreadsheet from <a class="reference external" href="https://nostarch.com/automatestuff2/">https://nostarch.com/automatestuff2/</a>. <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_produce_sht</span></code>  shows what the spreadsheet looks like.</p>
<figure class="align-center diagram invert align-default" id="id9">
<span id="tute-ss-fig-produce-sht"></span><img alt="A spreadsheet of produce sales" src="https://user-images.githubusercontent.com/11288701/208299752-dd9cdbe8-7171-4312-a578-c3e1b699b042.png" />
<figcaption>
<p><span class="caption-text">:A spreadsheet of produce sales</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Each row represents an individual sale.
The columns are the type of produce sold <code class="docutils literal notranslate"><span class="pre">A</span></code>, the cost per pound of that produce <code class="docutils literal notranslate"><span class="pre">B</span></code>, the number of pounds sold <code class="docutils literal notranslate"><span class="pre">C</span></code>, and the total revenue from the sale <code class="docutils literal notranslate"><span class="pre">D</span></code>.
The TOTAL column is set to the Excel formula`` =ROUND(B3*C3, 2)``, which multiplies the cost per pound by the number of pounds sold and rounds the result to the nearest cent.
With this formula, the cells in the TOTAL column will automatically update themselves if there is a change in column <code class="docutils literal notranslate"><span class="pre">B</span></code> or <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p>
<p>Now imagine that the prices of garlic, celery, and lemons were entered incorrectly,
leaving you with the boring task of going through thousands of rows in this spreadsheet to update the cost per pound for any garlic, celery, and lemon rows.
You can’t do a simple find-and-replace for the price, because there might be other items with the same price that you don’t want to mistakenly “correct.” For thousands of rows, this would take hours to do by hand.
But you can write a program that can accomplish this in seconds.</p>
<p>Your program does the following:</p>
<ul class="ul-list simple">
<li><p>Loops over all the rows</p></li>
<li><p>If the row is for garlic, celery, or lemons, changes the price</p></li>
</ul>
<p>This means your code will need to do the following:</p>
<ul class="ul-list simple">
<li><p>Open the spreadsheet file.</p></li>
<li><p>For each row, check whether the value in column A is Celery, Garlic, or Lemon.</p></li>
<li><p>If it is, update the price in column B.</p></li>
<li><p>Save the spreadsheet to a new file (so that you don’t lose the old spreadsheet, just in case).</p></li>
</ul>
</section>
</section>
<section id="step-1-set-up-a-data-structure-with-the-update-information">
<span id="tute-ss-step-set-data-structure"></span><h2>Step 1: Set Up a Data Structure with the Update Information<a class="headerlink" href="#step-1-set-up-a-data-structure-with-the-update-information" title="Permalink to this heading"></a></h2>
<p>The prices that you need to update are as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Celery</span>         <span class="mf">1.19</span>
<span class="n">Garlic</span>         <span class="mf">3.07</span>
<span class="n">Lemon</span>          <span class="mf">1.27</span>
</pre></div>
</div>
<p>You could write code like this:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-30-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-30-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-30-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-30-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-30-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">produceName</span> <span class="o">==</span> <span class="s1">&#39;Celery&#39;</span><span class="p">:</span>
    <span class="n">cellObj</span> <span class="o">=</span> <span class="mf">1.19</span>
<span class="k">if</span> <span class="n">produceName</span> <span class="o">==</span> <span class="s1">&#39;Garlic&#39;</span><span class="p">:</span>
    <span class="n">cellObj</span> <span class="o">=</span> <span class="mf">3.07</span>
<span class="k">if</span> <span class="n">produceName</span> <span class="o">==</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">:</span>
    <span class="n">cellObj</span> <span class="o">=</span> <span class="mf">1.27</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-30-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Having the produce and updated price data hardcoded like this is a bit inelegant. If you needed to update the spreadsheet again with different prices or different produce, you would have to change a lot of the code. Every time you change code, you risk introducing bugs.</p>
<p>A more flexible solution is to store the corrected price information in a dictionary and write your code to use this data structure.</p>
<p>In a new python REPL enter the following code:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-31-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-31-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-31-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-31-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-31-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># updateProduce.py - Corrects costs in produce sales spreadsheet.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">open_doc</span><span class="p">(</span><span class="s1">&#39;produceSales.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The produce types and their updated prices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PRICE_UPDATES</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Garlic&#39;</span><span class="p">:</span> <span class="mf">3.07</span><span class="p">,</span>
<span class="gp">... </span>                <span class="s1">&#39;Celery&#39;</span><span class="p">:</span> <span class="mf">1.19</span><span class="p">,</span>
<span class="gp">... </span>                <span class="s1">&#39;Lemon&#39;</span><span class="p">:</span> <span class="mf">1.27</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># TODO: Loop through the rows and update the prices.</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-31-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Save this as <code class="docutils literal notranslate"><span class="pre">updateProduce.py</span></code>.
If you need to update the spreadsheet again, you’ll need to update only the <code class="docutils literal notranslate"><span class="pre">PRICE_UPDATES</span></code> dictionary, not any other code.</p>
</section>
<section id="step-2-check-all-rows-and-update-incorrect-prices">
<span id="tute-ss-step-update-row-prices"></span><h2>Step 2: Check All Rows and Update Incorrect Prices<a class="headerlink" href="#step-2-check-all-rows-and-update-incorrect-prices" title="Permalink to this heading"></a></h2>
<p>The next part of the program will loop through all the rows in the spreadsheet.
In a previous section we explained it is much more efficient to read the whole range into an array, update the array, and write the array.</p>
<p>Add the following code to the bottom of your program:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-32-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-32-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-32-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-32-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-32-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">range_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;A2:D</span><span class="si">{</span><span class="n">Calc</span><span class="o">.</span><span class="n">get_row_used_last_index</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">range_name</span><span class="o">=</span><span class="n">range_name</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reading rows...&#39;</span><span class="p">)</span>
<span class="go">Reading rows...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">produce_name</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">sold</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">row</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">produce_name</span> <span class="ow">in</span> <span class="n">PRICE_UPDATES</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">PRICE_UPDATES</span><span class="p">[</span><span class="n">produce_name</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">sheet</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">range_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span> <span class="s2">&quot;updatedProduceSales.xlsx&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-32-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-32-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The code gets the <code class="docutils literal notranslate"><span class="pre">range_name</span></code> for the produce data starting at row <code class="docutils literal notranslate"><span class="pre">2</span></code>, since row <code class="docutils literal notranslate"><span class="pre">1</span></code> is just the header.
<code class="docutils literal notranslate"><span class="pre">Calc.get_array</span></code> returns tuples but a tuples cannot be changed so the tuples are converted to lists as the <code class="docutils literal notranslate"><span class="pre">data</span></code> is read in.</p>
<p>We loop through the rows in the data list.
The cell in column <code class="docutils literal notranslate"><span class="pre">1</span></code> (that is, column <code class="docutils literal notranslate"><span class="pre">A</span></code>) will be stored in the variable produce_name.
If <code class="docutils literal notranslate"><span class="pre">produce_name</span></code> exists as a key in the <code class="docutils literal notranslate"><span class="pre">PRICE_UPDATES</span></code> dictionary, then you know this is a row that must have its price corrected.
The correct price will be in <code class="docutils literal notranslate"><span class="pre">PRICE_UPDATES[produceName]</span></code>.</p>
<p>Notice how clean using <code class="docutils literal notranslate"><span class="pre">PRICE_UPDATES</span></code> makes the code.
Only one if statement, rather than code like if <code class="docutils literal notranslate"><span class="pre">produceName</span> <span class="pre">==</span> <span class="pre">'Garlic'</span></code>: , is necessary for every type of produce to update.
And since the code uses the <code class="docutils literal notranslate"><span class="pre">PRICE_UPDATES</span></code> dictionary instead of hardcoding the produce names and updated costs into the for loop,
you modify only the <code class="docutils literal notranslate"><span class="pre">PRICE_UPDATES</span></code> dictionary and not the code if the produce sales spreadsheet needs additional changes.</p>
<p>After going through the entire spreadsheet and making changes, the code saves the Workbook object to <code class="docutils literal notranslate"><span class="pre">updatedProduceSales.xlsx</span></code>.
It doesn’t overwrite the old spreadsheet just in case there’s a bug in your program and the updated spreadsheet is wrong.
After checking that the updated spreadsheet looks right, you can delete the old spreadsheet.</p>
</section>
<section id="tute-ss-ideas-simalar-programs">
<span id="id2"></span><h2>Ideas for Similar Programs<a class="headerlink" href="#tute-ss-ideas-simalar-programs" title="Permalink to this heading"></a></h2>
<p>Since many office workers use Excel spreadsheets all the time, a program that can automatically edit and write Excel files could be really useful.
Such a program could do the following:</p>
<p>Read data from one spreadsheet and write it to parts of other spreadsheets.
Read data from websites, text files, or the clipboard and write it to a spreadsheet.
Automatically “clean up” data in spreadsheets.
For example, it could use regular expressions to read multiple formats of phone numbers and edit them to a single, standard format.</p>
<section id="setting-the-font-style-of-cells">
<span id="tute-ss-set-cell-font-style"></span><h3>Setting the Font Style of Cells<a class="headerlink" href="#setting-the-font-style-of-cells" title="Permalink to this heading"></a></h3>
<p>Styling certain cells, rows, or columns can help you emphasize important areas in your spreadsheet.
In the produce spreadsheet, for example, your program could apply bold text to the potato, garlic, and parsnip rows.
Or perhaps you want to italicize every row with a cost per pound greater than <code class="docutils literal notranslate"><span class="pre">$5</span></code>.
Styling parts of a large spreadsheet by hand would be tedious, but your programs can do it instantly.</p>
<p>To customize font styles in cells the OooDev Props class and two <code class="docutils literal notranslate"><span class="pre">ooo.dyn.awt</span></code> import from  <a href="#id22"><span class="problematic" id="id23">|ooouno|_</span></a> classes, <code class="docutils literal notranslate"><span class="pre">FontSlant</span></code> and <code class="docutils literal notranslate"><span class="pre">FontWeight</span></code>, must be imported.</p>
<p>Note that an alias has been used on the classes to make them easier to recognise.</p>
<p>Here’s an example that creates a new workbook and sets cell <code class="docutils literal notranslate"><span class="pre">A1</span></code> to have an italicized, bold, 24-point font.
Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-33-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-33-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-33-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-33-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-33-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span> <span class="c1"># create some data in column A</span>
<span class="gp">... </span>    <span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.props</span> <span class="kn">import</span> <span class="n">Props</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooo.dyn.awt.font_slant</span> <span class="kn">import</span> <span class="n">FontSlant</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooo.dyn.awt.font_weight</span> <span class="kn">import</span> <span class="n">FontWeight</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_cell</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Props</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">CharPosture</span><span class="o">=</span><span class="n">FontSlant</span><span class="o">.</span><span class="n">ITALIC</span><span class="p">,</span> <span class="n">CharWeight</span><span class="o">=</span><span class="n">FontWeight</span><span class="o">.</span><span class="n">BOLD</span><span class="p">,</span> <span class="n">CharHeight</span><span class="o">=</span><span class="mi">24</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s2">&quot;sampleChart.xlsx&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-33-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-33-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>In this example, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.get_cell()</span></code> returns an <a class="reference external" href="https://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1table_1_1XCell.html">XCell</a> type with is used to reference the cell in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Props.set()</span></code> and set the properties directly.
<code class="docutils literal notranslate"><span class="pre">CharPosture</span></code> and <code class="docutils literal notranslate"><span class="pre">CharWeight</span></code> use the <code class="docutils literal notranslate"><span class="pre">FontSlat</span></code> and <code class="docutils literal notranslate"><span class="pre">FontWeight</span></code> classes respectively as previously imported.
<code class="docutils literal notranslate"><span class="pre">CharHeight</span></code> is set directly. The effect is shown in the saved file.</p>
</section>
<section id="font-objects">
<span id="tute-ss-font-objects"></span><h3>Font Objects<a class="headerlink" href="#font-objects" title="Permalink to this heading"></a></h3>
<p>A number of OooDev classes have methods to change font properties.
<code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_tbl_props_for_font_objects</span></code> shows key properties for Font objects.</p>
<span id="tute-ss-tbl-props-for-font-objects"></span><table class="docutils align-default" id="props-for-font-objects">
<caption><span class="caption-text">Properties for Font Objects.</span><a class="headerlink" href="#props-for-font-objects" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Data type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="3"><p>name</p></td>
<td rowspan="3"><p>String</p></td>
<td rowspan="3"><p>The font name, such as ‘Calibri’
or ‘Times New Roman’</p></td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>size</p></td>
<td rowspan="2"><p>Integer</p></td>
<td rowspan="2"><p>The point size</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>bold</p></td>
<td rowspan="2"><p>Boolean</p></td>
<td rowspan="2"><p>True, for bold font</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>italic</p></td>
<td rowspan="2"><p>Boolean</p></td>
<td rowspan="2"><p>True, for italic font</p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
<p>The best way of setting font attributes is to define a style and apply it to the required objects.
In this example a spreadsheet is created the a style is; named, created, properties set, and applied to a cell object.
The cell value is then set which demonstrates the new style, and the process is repeated again.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-34-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-34-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-34-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-34-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-34-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.props</span> <span class="kn">import</span> <span class="n">Props</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooo.dyn.awt.font_slant</span> <span class="kn">import</span> <span class="n">FontSlant</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooo.dyn.awt.font_weight</span> <span class="kn">import</span> <span class="n">FontWeight</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Name style</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">HEADER_STYLE_NAME</span> <span class="o">=</span> <span class="s2">&quot;My HeaderStyle&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create style</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">style1</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_cell_style</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span> <span class="n">style_name</span><span class="o">=</span><span class="n">HEADER_STYLE_NAME</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set style properties</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Props</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style1</span><span class="p">,</span> <span class="n">CharWeight</span><span class="o">=</span><span class="n">FontWeight</span><span class="o">.</span><span class="n">BOLD</span><span class="p">,</span> <span class="n">CharHeight</span><span class="o">=</span><span class="mi">14</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply style</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">change_style</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">style_name</span><span class="o">=</span><span class="n">HEADER_STYLE_NAME</span><span class="p">,</span> <span class="n">range_name</span><span class="o">=</span><span class="s2">&quot;A1:A1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set cell value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;Bold Times New Roman&#39;</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Repeat for data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DATA_STYLE_NAME</span> <span class="o">=</span> <span class="s2">&quot;My DataStyle&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">style2</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_cell_style</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span> <span class="n">style_name</span><span class="o">=</span><span class="n">DATA_STYLE_NAME</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Props</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style2</span><span class="p">,</span> <span class="n">CharPosture</span><span class="o">=</span><span class="n">FontSlant</span><span class="o">.</span><span class="n">ITALIC</span><span class="p">,</span> <span class="n">CharHeight</span><span class="o">=</span><span class="mi">24</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">change_style</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">style_name</span><span class="o">=</span><span class="n">DATA_STYLE_NAME</span><span class="p">,</span> <span class="n">range_name</span><span class="o">=</span><span class="s2">&quot;B3:B3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;24 pt Italic&#39;</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s2">&quot;styles.xlsx&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-34-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-34-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>Here, we store a style name in a <code class="docutils literal notranslate"><span class="pre">STYLE_NAME</span></code> constant, create a style with <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.create_cell_style()</span></code> method,
use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Props.set()</span></code> method to set the style properties, then set the cell value with the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.set_val()</span></code> method.
We repeat the process with another style for a second cell.
After you run this code, the styles of the <code class="docutils literal notranslate"><span class="pre">A1</span></code> and <code class="docutils literal notranslate"><span class="pre">B3</span></code> cells in the spreadsheet will be set to custom character styles, as shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_custom_font_styles</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id10">
<span id="tute-ss-fig-custom-font-styles"></span><img alt="A spreadsheet with custom font styles" src="https://user-images.githubusercontent.com/11288701/208299766-0bfc9ef8-9675-4266-80b8-c8c57059f2ea.png" />
<figcaption>
<p><span class="caption-text">:A spreadsheet with custom font styles</span><a class="headerlink" href="#id10" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>For cell A1, we set the font name to <code class="docutils literal notranslate"><span class="pre">Times</span> <span class="pre">New</span> <span class="pre">Roman</span></code> and set bold to true, so our text appears in bold Times New Roman.
We didn’t specify a size, so the default is used.
In cell <code class="docutils literal notranslate"><span class="pre">B3</span></code>, our text is italic, with a size of <code class="docutils literal notranslate"><span class="pre">24</span></code>; we didn’t specify a font name, so the default, <code class="docutils literal notranslate"><span class="pre">Calibri</span></code>, is used.</p>
</section>
<section id="formulas">
<span id="tute-ss-formulas"></span><h3>Formulas<a class="headerlink" href="#formulas" title="Permalink to this heading"></a></h3>
<p>Spreadsheet formulas, which begin with an equal sign, can configure cells to contain values calculated from other cells.
In this section, you’ll use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.set_val()</span></code> to set a formula on a cell, just like any normal value.
For example:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-35-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-35-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-35-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-35-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-35-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;B9&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;=SUM(B1:B8)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-35-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-35-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>This will store <code class="docutils literal notranslate"><span class="pre">=SUM(B1:B8)</span></code> as the value in cell <code class="docutils literal notranslate"><span class="pre">B9</span></code>. This sets the <code class="docutils literal notranslate"><span class="pre">B9</span></code> cell to a formula that calculates the sum of values in cells <code class="docutils literal notranslate"><span class="pre">B1</span></code> to <code class="docutils literal notranslate"><span class="pre">B8</span></code>.
You can see this in action in <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_figb9_b1_b8</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id11">
<span id="tute-ss-figb9-b1-b8"></span><img alt=":Cell B9 contains the formula =SUM(B1:B8), which adds the cells B1 to B8" src="https://user-images.githubusercontent.com/11288701/208299779-ff5d2bfa-8e36-4606-8bd3-e48a0704a80d.png" />
<figcaption>
<p><span class="caption-text">:Cell <code class="docutils literal notranslate"><span class="pre">B9</span></code> contains the formula <code class="docutils literal notranslate"><span class="pre">=SUM(B1:B8)</span></code>, which adds the cells <code class="docutils literal notranslate"><span class="pre">B1</span></code> to <code class="docutils literal notranslate"><span class="pre">B8</span></code></span><a class="headerlink" href="#id11" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>A formula is set just like any other text value in a cell. Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-36-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-36-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-36-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-36-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-36-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;=SUM(A1:A2)&quot;</span><span class="p">)</span> <span class="c1"># Set the formula</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s2">&quot;writeFormula.xlsx&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-36-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-36-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The cells in <code class="docutils literal notranslate"><span class="pre">A1</span></code> and <code class="docutils literal notranslate"><span class="pre">A2</span></code> are set to <code class="docutils literal notranslate"><span class="pre">200</span></code> and <code class="docutils literal notranslate"><span class="pre">300</span></code>, respectively with the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.set_val()</span></code> method.
The value in cell <code class="docutils literal notranslate"><span class="pre">A3</span></code> is set to a formula that sums the values in <code class="docutils literal notranslate"><span class="pre">A1</span></code> and <code class="docutils literal notranslate"><span class="pre">A2</span></code>.
When the spreadsheet is opened, <code class="docutils literal notranslate"><span class="pre">A3</span></code> will display its value as <code class="docutils literal notranslate"><span class="pre">500</span></code>.</p>
<p>Formulas offer a level of programmability for spreadsheets but can quickly become unmanageable for complicated tasks.
For example, even if you’re deeply familiar with formulas, it’s a headache to try to decipher what the following actually does:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>=IFERROR(TRIM(IF(LEN(VLOOKUP(F7, Sheet2!$A$1:$B$10000, 2, FALSE))&gt;0,SUBSTITUTE(VLOOKUP(F7, Sheet2!$A$1:$B$10000, 2, FALSE), &quot; &quot;, &quot;&quot;),&quot;&quot;)), &quot;&quot;)
</pre></div>
</div>
<p>Python code is much more readable.</p>
</section>
<section id="adjusting-rows-and-columns">
<span id="tute-ss-adjusting-rows-cols"></span><h3>Adjusting Rows and Columns<a class="headerlink" href="#adjusting-rows-and-columns" title="Permalink to this heading"></a></h3>
<p>Adjusting the sizes of rows and columns is as easy as clicking and dragging the edges of a row or column header.
But if you need to set a row or column’s size based on its cells’ contents or if you want to set sizes in a large number of spreadsheet files, it will be much quicker to write a Python program to do it.</p>
<p>Rows and columns can also be hidden entirely from view.
Or they can be “frozen” in place so that they are always visible on the screen and appear on every page when the spreadsheet is printed (which is handy for headers).</p>
</section>
</section>
<section id="setting-row-height-and-column-width">
<span id="tute-ss-setting-row-col-width"></span><h2>Setting Row Height and Column Width<a class="headerlink" href="#setting-row-height-and-column-width" title="Permalink to this heading"></a></h2>
<p>Worksheet objects have row_dimensions and <code class="docutils literal notranslate"><span class="pre">column_dimensions</span></code> properties that control row heights and column widths.
Enter this into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-37-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-37-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-37-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-37-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-37-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Tall row&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Wide column&#39;</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set the height and width:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">set_row_height</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">set_col_width</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s1">&#39;dimensions.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-37-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-37-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>A sheet’s row_dimensions and <code class="docutils literal notranslate"><span class="pre">column_dimensions</span></code> are dictionary-like values; <code class="docutils literal notranslate"><span class="pre">row_dimensions</span></code> contains <code class="docutils literal notranslate"><span class="pre">RowDimension</span></code> objects and <code class="docutils literal notranslate"><span class="pre">column_dimensions</span></code> contains <code class="docutils literal notranslate"><span class="pre">ColumnDimension</span></code> objects.
In <code class="docutils literal notranslate"><span class="pre">row_dimensions</span></code>, you can access one of the objects using the number of the row (in this case, <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">2</span></code>).
In <code class="docutils literal notranslate"><span class="pre">column_dimensions</span></code>, you can access one of the objects using the letter of the column (in this case, <code class="docutils literal notranslate"><span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">B</span></code>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dimensions.xlsx</span></code> spreadsheet looks like <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_rot1b_larger</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id12">
<span id="tute-ss-fig-rot1b-larger"></span><img alt="Row 1 and column B set to larger heights and widths" src="https://user-images.githubusercontent.com/11288701/208299789-682e72d3-b7f5-44c2-b941-96bc0854b41c.png" />
<figcaption>
<p><span class="caption-text">:Row <code class="docutils literal notranslate"><span class="pre">1</span></code> and column <code class="docutils literal notranslate"><span class="pre">B</span></code> set to larger heights and widths</span><a class="headerlink" href="#id12" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Once you have the RowDimension object, you can set its height.
Once you have the <code class="docutils literal notranslate"><span class="pre">ColumnDimension</span></code> object, you can set its width.
The row height can be set to an integer or float value between 0 and 409.
This value represents the height measured in points, where one point equals 1/72 of an inch.
The default row height is 12.75. The column width can be set to an integer or float value between 0 and 255.
This value represents the number of characters at the default font size (11 point) that can be displayed in the cell.
The default column width is 8.43 characters.
Columns with widths of 0 or rows with heights of 0 are hidden from the user.</p>
</section>
<section id="merging-and-unmerging-cells">
<h2>Merging and Unmerging Cells<a class="headerlink" href="#merging-and-unmerging-cells" title="Permalink to this heading"></a></h2>
<p>A rectangular area of cells can be merged into a single cell with the <code class="docutils literal notranslate"><span class="pre">merge_cells()</span></code> sheet method.
Enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-38-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-38-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-38-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-38-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-38-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Merge first few cells of the last row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_range</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_cell_range</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;A1:D3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">com.sun.star.util</span> <span class="kn">import</span> <span class="n">XMergeable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xmerge</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">qi</span><span class="p">(</span><span class="n">XMergeable</span><span class="p">,</span> <span class="n">cell_range</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xmerge</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;Twelve cells merged together.&#39;</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_range</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_cell_range</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;C5:D5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xmerge</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">qi</span><span class="p">(</span><span class="n">XMergeable</span><span class="p">,</span> <span class="n">cell_range</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xmerge</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;Two merged cells.&#39;</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s1">&#39;merged.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-38-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-38-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>The argument to <code class="docutils literal notranslate"><span class="pre">merge_cells()</span></code> is a single string of the top-left and bottom-right cells of the rectangular area to be merged: <code class="docutils literal notranslate"><span class="pre">A1:D3</span></code> merges <code class="docutils literal notranslate"><span class="pre">12</span></code> cells into a single cell.
To set the value of these merged cells, simply set the value of the top-left cell of the merged group.</p>
<p>When you run this code, merged.xlsx will look like <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_merged_cells</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id13">
<span id="tute-ss-fig-merged-cells"></span><img alt="Merged cells in a spreadsheet" src="https://user-images.githubusercontent.com/11288701/208299799-b8b51ce7-8f6c-46f0-8aec-e62bc571c609.png" />
<figcaption>
<p><span class="caption-text">:Merged cells in a spreadsheet</span><a class="headerlink" href="#id13" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>To unmerge cells, call the <code class="docutils literal notranslate"><span class="pre">unmerge_cells()</span></code> sheet method.
Enter this into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-39-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-39-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-39-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-39-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-39-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xmerge</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Split up last merged cells</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_range</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_cell_range</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s1">&#39;A1:D3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">qi</span><span class="p">(</span><span class="n">XMergeable</span><span class="p">,</span> <span class="n">cell_range</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s1">&#39;merged.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-39-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-39-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>If you save your changes and then take a look at the spreadsheet, you’ll see that the merged cells have gone back to being individual cells.</p>
</section>
<section id="freezing-panes">
<h2>Freezing Panes<a class="headerlink" href="#freezing-panes" title="Permalink to this heading"></a></h2>
<p>For spreadsheets too large to be displayed all at once, it’s helpful to “freeze” a few of the top rows or leftmost columns onscreen.
Frozen column or row headers, for example, are always visible to the user even as they scroll through the spreadsheet.
These are known as freeze panes. In OpenPyXL, each Worksheet object has a freeze_panes property that can be set to a Cell object or a string of a cell’s coordinates.
Note that all rows above and all columns to the left of this cell will be frozen, but the row and column of the cell itself will not be frozen.</p>
<p>To unfreeze all panes, set freeze_panes to None or <code class="docutils literal notranslate"><span class="pre">A1</span></code>. <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_tbl_frozen_pane_ex</span></code> shows which rows and columns will be frozen for some example settings of <code class="docutils literal notranslate"><span class="pre">freeze_panes</span></code>.</p>
<span id="tute-ss-tbl-frozen-pane-ex"></span><table class="docutils align-default" id="tbl-frozen-pane-ex">
<caption><span class="caption-text">Frozen Pane Examples.</span><a class="headerlink" href="#tbl-frozen-pane-ex" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>freeze_panes setting</p></th>
<th class="head"><p>Rows and columns frozen</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sheet.freeze_panes = ‘A2’</p></td>
<td><p>Row 1</p></td>
</tr>
<tr class="row-odd"><td><p>sheet.freeze_panes = ‘B1’</p></td>
<td><p>Column A</p></td>
</tr>
<tr class="row-even"><td><p>sheet.freeze_panes = ‘C1’</p></td>
<td><p>Columns A and B</p></td>
</tr>
<tr class="row-odd"><td><p>sheet.freeze_panes = ‘C2’</p></td>
<td><p>Row 1 and columns A and B</p></td>
</tr>
<tr class="row-even"><td><dl class="simple">
<dt>sheet.freeze_panes = ‘A1’</dt><dd><p>or sheet.freeze_panes = None</p>
</dd>
</dl>
</td>
<td><p>No frozen panes</p></td>
</tr>
</tbody>
</table>
<p>Make sure you have the produce sales spreadsheet from <a class="reference external" href="https://nostarch.com/automatestuff2/">https://nostarch.com/automatestuff2/</a>.
Then enter the following into the interactive shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-40-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-40-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-40-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-40-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-40-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectSocket</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">open_doc</span><span class="p">(</span><span class="s1">&#39;produceSales.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">goto_cell</span><span class="p">(</span><span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span> <span class="c1"># activate reference row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">freeze_rows</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span> <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># freeze one row before reference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s1">&#39;freezeExample.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-40-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-40-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>If you set the freeze_panes property to <code class="docutils literal notranslate"><span class="pre">A2</span></code>, row <code class="docutils literal notranslate"><span class="pre">1</span></code> will always be viewable, no matter where the user scrolls in the spreadsheet.
You can see this in <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_freeze_a2</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id14">
<span id="tute-ss-fig-freeze-a2"></span><img alt="With freeze_panes set to A2, row 1 is always visible, even as the user scrolls down" src="https://user-images.githubusercontent.com/11288701/208299812-13dd64f0-5dca-4906-af52-5cf4e90e6622.png" />
<figcaption>
<p><span class="caption-text">:With freeze_panes set to <code class="docutils literal notranslate"><span class="pre">A2</span></code>, row <code class="docutils literal notranslate"><span class="pre">1</span></code> is always visible, even as the user scrolls down</span><a class="headerlink" href="#id14" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<section id="charts">
<span id="tute-ss-charts"></span><h3>Charts<a class="headerlink" href="#charts" title="Permalink to this heading"></a></h3>
<p>OooDev supports creating many charts including bar, line, scatter, and pie charts using the data in a sheet’s cells. To make a chart, you need to do the following:</p>
<ul class="ul-list simple">
<li><p>Create a Reference object from a rectangular selection of cells.</p></li>
<li><p>Create a Series object by passing in the Reference object.</p></li>
<li><p>Create a Chart object.</p></li>
<li><p>Append the Series object to the Chart object.</p></li>
<li><p>Add the Chart object to the Worksheet object, optionally specifying which cell should be the top-left corner of the chart.</p></li>
</ul>
<p>The Reference object requires some explaining.
You create Reference objects by calling the <strong>*openpyxl*</strong>.chart.Reference() function and passing three arguments:</p>
<p>The Worksheet object containing your chart data.
A tuple of two integers, representing the top-left cell of the rectangular selection of cells containing your chart data: the first integer in the tuple is the row, and the second is the column. Note that 1 is the first row, not 0.
A tuple of two integers, representing the bottom-right cell of the rectangular selection of cells containing your chart data: the first integer in the tuple is the row, and the second is the column.
<code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_tuple_vals</span></code> shows some sample coordinate arguments.</p>
<figure class="align-center diagram invert align-default" id="id15">
<span id="tute-ss-fig-tuple-vals"></span><img alt="tuple values" src="https://user-images.githubusercontent.com/11288701/208299822-1620a00b-f148-4ff3-9086-8f4b55c60273.png" />
<figcaption>
<p><span class="caption-text">From left to right: (1, 1), (10, 1); (3, 2), (6, 4); (5, 3), (5, 3)</span><a class="headerlink" href="#id15" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Enter this interactive shell example to create a bar chart and add it to the spreadsheet:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-41-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-41-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-41-Tm9uZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-41-Tm9uZQ==" name="Tm9uZQ==" role="tab" tabindex="-1">None</button></div><div aria-labelledby="tab-41-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-41-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.calc</span> <span class="kn">import</span> <span class="n">Calc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.office.chart2</span> <span class="kn">import</span> <span class="n">Chart2</span><span class="p">,</span> <span class="n">Angle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.gui</span> <span class="kn">import</span> <span class="n">GUI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ooodev.utils.lo</span> <span class="kn">import</span> <span class="n">Lo</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">load_office</span><span class="p">(</span><span class="n">connector</span><span class="o">=</span><span class="n">Lo</span><span class="o">.</span><span class="n">ConnectPipe</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">create_doc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GUI</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span> <span class="c1"># create some data in column A</span>
<span class="gp">... </span>    <span class="n">Calc</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_addr</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">get_address</span><span class="p">(</span><span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">range_name</span><span class="o">=</span><span class="s2">&quot;A1:A10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart_doc</span> <span class="o">=</span> <span class="n">Chart2</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sheet</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cells_range</span><span class="o">=</span><span class="n">range_addr</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;C5&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Calc</span><span class="o">.</span><span class="n">goto_cell</span><span class="p">(</span><span class="n">cell_name</span><span class="o">=</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Chart2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">chart_doc</span><span class="o">=</span><span class="n">chart_doc</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;My Chart&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Chart2</span>
<span class="go">&lt;class &#39;ooodev.office.chart2.Chart2&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Calc</span><span class="o">.</span><span class="n">save_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s2">&quot;sampleChart.xlsx&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lo</span><span class="o">.</span><span class="n">close_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">Lo</span><span class="o">.</span><span class="n">close_office</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-41-Tm9uZQ==" class="sphinx-tabs-panel group-tab tab-none" hidden="true" id="panel-41-Tm9uZQ==" name="Tm9uZQ==" role="tabpanel" tabindex="0"></div></div>
<p>This produces a spreadsheet that looks like Figure 13-10.</p>
<figure class="align-center diagram invert align-default" id="id16">
<span id="ch01fig-timeline"></span><img alt="OpenOffice Timeline Image" src="https://user-images.githubusercontent.com/11288701/208299968-9fdc7c59-b2ca-4369-bb9a-364c41c67f5a.png" />
<figcaption>
<p><span class="caption-text">:A spreadsheet with a chart added</span><a class="headerlink" href="#id16" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>We’ve created a bar chart by using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Calc.get_address()</span></code> method to set a range to <code class="docutils literal notranslate"><span class="pre">A1:A10</span></code>, then using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Chart2.insert_chart()</span></code> method to insert the chart at <code class="docutils literal notranslate"><span class="pre">C5</span></code>.
The default insert a column chart with no row or column values and default colours.
You can create many chart types including: line charts, scatter charts, and pie charts.</p>
</section>
<section id="summary">
<span id="tute-ss-summary"></span><h3>Summary<a class="headerlink" href="#summary" title="Permalink to this heading"></a></h3>
<p>Often the hard part of processing information isn’t the processing itself but simply getting the data in the right format for your program.
But once you have your spreadsheet loaded into Python, you can extract and manipulate its data much faster than you could by hand.</p>
<p>You can also generate spreadsheets as output from your programs.
So if colleagues need your text file or PDF of thousands of sales contacts transferred to a spreadsheet file, you won’t have to tediously copy and paste it all into spreadsheets.</p>
<p>Equipped with OooDev module and some programming knowledge, you’ll find processing even the biggest spreadsheets a piece of cake.</p>
</section>
<section id="practice-questions">
<span id="tute-ss-practice-questions"></span><h3>Practice Questions<a class="headerlink" href="#practice-questions" title="Permalink to this heading"></a></h3>
<p>For the following questions, imagine you have a Workbook object in the variable wb, a Worksheet object in <code class="docutils literal notranslate"><span class="pre">sheet</span></code>, a Cell object in <code class="docutils literal notranslate"><span class="pre">cell</span></code>, a Comment object in <code class="docutils literal notranslate"><span class="pre">comm</span></code>, and an Image object in <code class="docutils literal notranslate"><span class="pre">img</span></code>.</p>
<ol class="arabic simple">
<li><p>What does the ‘Calc.open_doc()’ function return?</p></li>
<li><p>What does the ‘Calc.get_sheet_names(wb)’ object contain?</p></li>
<li><p>How would you retrieve the Worksheet object for a sheet named ‘Sheet1’?</p></li>
<li><p>How would you retrieve the Worksheet object for the workbook’s active sheet?</p></li>
<li><p>How would you retrieve the value in the cell C5?</p></li>
<li><p>How would you set the value in the cell C5 to “Hello”?</p></li>
<li><p>How would you retrieve the cell’s row and column as integers?</p></li>
<li><p>What do the ‘get_column_used_last_index(sheet)’ and ‘get_row_used_last_index(sheet)’ properties hold, and what is the data type of these properties?</p></li>
<li><p>If you needed to get the integer index for column ‘M’, what function would you need to call?</p></li>
<li><p>If you needed to get the string name for column 14, what function would you need to call?</p></li>
<li><p>How can you retrieve a tuple of all the Cell objects from A1 to F1?</p></li>
<li><p>How would you save the workbook to the filename example.xlsx?</p></li>
<li><p>How do you set a formula in a cell?</p></li>
<li><p>If you want to retrieve the result of a cell’s formula instead of the cell’s formula itself, what must you do first?</p></li>
<li><p>How would you set the height of row 5 to 100?</p></li>
<li><p>How would you hide column C?</p></li>
<li><p>What is a freeze pane?</p></li>
<li><p>What five functions and methods do you have to call to create a bar chart?</p></li>
</ol>
</section>
<section id="practice-projects">
<span id="tute-ss-practice-projects"></span><h3>Practice Projects<a class="headerlink" href="#practice-projects" title="Permalink to this heading"></a></h3>
<p>For practice, write programs that perform the following tasks.</p>
</section>
</section>
<section id="multiplication-table-maker">
<span id="tute-ss-multiplicaton-tbl"></span><h2>Multiplication Table Maker<a class="headerlink" href="#multiplication-table-maker" title="Permalink to this heading"></a></h2>
<p>Create a program <code class="docutils literal notranslate"><span class="pre">multiplicationTable.py</span></code> that takes a number <code class="docutils literal notranslate"><span class="pre">N</span></code> from the command line and creates an <code class="docutils literal notranslate"><span class="pre">NxN</span></code> multiplication table in a spreadsheet.
For example, when the program is run like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">py</span> <span class="n">multiplicationTable</span><span class="o">.</span><span class="n">py</span> <span class="mi">6</span>
</pre></div>
</div>
<p>… it should create a spreadsheet that looks like <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_multiplication_tbl</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id17">
<span id="tute-ss-fig-multiplication-tbl"></span><img alt="A multiplication table generated in a spreadsheet" src="https://user-images.githubusercontent.com/11288701/208299901-74f36232-747a-4803-adfa-ae6d66fab93d.png" />
<figcaption>
<p><span class="caption-text">:A multiplication table generated in a spreadsheet</span><a class="headerlink" href="#id17" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Row <code class="docutils literal notranslate"><span class="pre">1</span></code> and column <code class="docutils literal notranslate"><span class="pre">A</span></code> should be used for labels and should be in bold.</p>
</section>
<section id="blank-row-inserter">
<span id="tute-ss-blank-row-inserter"></span><h2>Blank Row Inserter<a class="headerlink" href="#blank-row-inserter" title="Permalink to this heading"></a></h2>
<p>Create a program <code class="docutils literal notranslate"><span class="pre">blankRowInserter.py</span></code> that takes two integers and a filename string as command line arguments.
Let’s call the first integer <code class="docutils literal notranslate"><span class="pre">N</span></code> and the second integer <code class="docutils literal notranslate"><span class="pre">M</span></code>.
Starting at row <code class="docutils literal notranslate"><span class="pre">N</span></code>, the program should insert <code class="docutils literal notranslate"><span class="pre">M</span></code> blank rows into the spreadsheet.
For example, when the program is run like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">blankRowInserter</span><span class="o">.</span><span class="n">py</span> <span class="mi">3</span> <span class="mi">2</span> <span class="n">myProduce</span><span class="o">.</span><span class="n">xlsx</span>
</pre></div>
</div>
<p>… the “before” and “after” spreadsheets should look like <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_ex_inserted_row_3</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id18">
<span id="tute-ss-fig-ex-inserted-row-3"></span><img alt="Before (left) and after (right) the two blank rows are inserted at row 3" src="https://user-images.githubusercontent.com/11288701/208299859-486ca40a-0bbf-46e4-add9-5fa101781563.png" />
<figcaption>
<p><span class="caption-text">Before (left) and after (right) the two blank rows are inserted at row 3</span><a class="headerlink" href="#id18" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>You can write this program by reading in the contents of the spreadsheet.
Then, when writing out the new spreadsheet, use a for loop to copy the first N lines.
For the remaining lines, add M to the row number in the output spreadsheet.</p>
</section>
<section id="spreadsheet-cell-inverter">
<span id="tute-ss-sht-cell-invert"></span><h2>Spreadsheet Cell Inverter<a class="headerlink" href="#spreadsheet-cell-inverter" title="Permalink to this heading"></a></h2>
<p>Write a program to invert the row and column of the cells in the spreadsheet.
For example, the value at row <code class="docutils literal notranslate"><span class="pre">5</span></code>, column <code class="docutils literal notranslate"><span class="pre">3</span></code> will be at row <code class="docutils literal notranslate"><span class="pre">3</span></code>, column <code class="docutils literal notranslate"><span class="pre">5</span></code> (and vice versa).
This should be done for all cells in the spreadsheet.
For example, the “before” and “after” spreadsheets would look something like <code class="xref std std-numref docutils literal notranslate"><span class="pre">tute_ss_fig_sht_before_after_top_btm</span></code>.</p>
<figure class="align-center diagram invert align-default" id="id19">
<span id="tute-ss-fig-sht-before-after-top-btm"></span><img alt="The spreadsheet before (top) and after (bottom) inversion" src="https://user-images.githubusercontent.com/11288701/208299872-1d3fec93-a74f-4660-a6af-fde3ad9ae33d.png" />
<figcaption>
<p><span class="caption-text">The spreadsheet before (top) and after (bottom) inversion</span><a class="headerlink" href="#id19" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>You can write this program by using nested for loops to read the spreadsheet’s data into a list of lists data structure.
This data structure could have <code class="docutils literal notranslate"><span class="pre">sheet_data[x][y]</span></code> for the cell at column x and row y.
Then, when writing out the new spreadsheet, use <code class="docutils literal notranslate"><span class="pre">sheet_data[y][x]</span></code> for the cell at column <code class="docutils literal notranslate"><span class="pre">x</span></code> and row <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</section>
<section id="text-files-to-spreadsheet">
<span id="text-ss-text-file-sht"></span><h2>Text Files to Spreadsheet<a class="headerlink" href="#text-files-to-spreadsheet" title="Permalink to this heading"></a></h2>
<p>Write a program to read in the contents of several text files (you can make the text files yourself) and insert those contents into a spreadsheet, with one line of text per row.
The lines of the first text file will be in the cells of column <code class="docutils literal notranslate"><span class="pre">A</span></code>, the lines of the second text file will be in the cells of column <code class="docutils literal notranslate"><span class="pre">B</span></code>, and so on.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> File object method to return a list of strings, one string per line in the file.
For the first file, output the first line to column <code class="docutils literal notranslate"><span class="pre">1</span></code>, row <code class="docutils literal notranslate"><span class="pre">1</span></code>.
The second line should be written to column <code class="docutils literal notranslate"><span class="pre">1</span></code>, row <code class="docutils literal notranslate"><span class="pre">2</span></code>, and so on.
The next file that is read with <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> will be written to column <code class="docutils literal notranslate"><span class="pre">2</span></code>, the next file to column 3``, and so on.</p>
</section>
<section id="spreadsheet-to-text-files">
<span id="tute-ss-sht-to-txt-file"></span><h2>Spreadsheet to Text Files<a class="headerlink" href="#spreadsheet-to-text-files" title="Permalink to this heading"></a></h2>
<p>Write a program that performs the tasks of the previous program in reverse order: the program should open a spreadsheet and write the cells of column <code class="docutils literal notranslate"><span class="pre">A</span></code> into one text file,
the cells of column B into another text file, and so on.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, flywire.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>